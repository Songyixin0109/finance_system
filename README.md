# 📊 金融数据挖掘系统 - 课程大作业

## 🎯 项目简介

这是一个基于Python的金融数据分析平台，集成了**金融文献分析**、**股票数据获取**、**数据可视化**和**机器学习预测**等核心功能。项目采用模块化设计，提供了完整的GUI界面，作为《Python与金融挖掘》课程的综合性大作业。

## 🛠️ 技术栈

### 后端技术
- **编程语言**：Python 3.7+
- **数据处理**：Pandas, NumPy
- **机器学习**：Scikit-learn
- **文本处理**：Jieba, SnowNLP, pdfplumber
- **数据可视化**：Matplotlib, Seaborn, WordCloud
- **数据库**：MySQL

### 前端技术
- **GUI框架**：Tkinter（Python标准库）
- **界面组件**：ttk（主题化组件）
- **图像处理**：PIL (Pillow), ImageIO

### 数据获取技术
- **API接口**：Tushare金融数据API
- **爬虫技术**：模拟数据生成 + API请求
- **数据存储**：本地CSV/Excel + MySQL数据库
- **文档解析**：PDF文本提取

### 系统架构
- **设计模式**：MVC架构（模型-视图-控制器）
- **并发处理**：多线程技术避免界面阻塞
- **模块化设计**：功能模块独立，易于扩展
- **错误处理**：完善的异常捕获和用户提示

## ✨ 核心功能

### 📚 实验一：金融文献与数据分析
- **PDF文档解析**：支持金融文献PDF文件的加载和文本提取
- **词频统计分析**：中文分词、高频词统计、词云图生成
- **情感分析**：基于SnowNLP的金融文本情感倾向分析
- **数据可视化**：词云图、词频柱状图、情感分布饼图

### 📈 实验二：数据爬取与机器学习
- **股票数据获取**：集成Tushare API，支持真实/模拟数据
- **数据库管理**：MySQL数据库存储与查询（可选）
- **机器学习预测**：
  - **回归分析**：股价数值预测（线性回归、随机森林、SVM）
  - **分类预测**：股价涨跌预测（逻辑回归、随机森林、SVM）
  - **聚类分析**：股价模式识别（K-Means、DBSCAN、层次聚类）
- **可视化展示**：预测结果对比图、混淆矩阵、聚类散点图

## 🏗️ 项目结构

```
finance_system/
├── main.py                          # 主程序入口（GUI界面）
├── experiment1.py                   # 实验一核心逻辑
├── experiment2.py                   # 实验二核心逻辑
├── visualizer.py                    # 数据可视化模块
├── financial_document_analyzer.py   # 金融文献分析模块
├── ml_predictor.py                  # 机器学习预测模块
├── data_fetcher.py                  # 数据爬取模块（支持Tushare）
├── database.py                      # 数据库管理模块
├── requirements.txt                 # 项目依赖包列表
├── README.md                        # 项目说明文档
└── result/                          # 结果输出目录（自动生成）
    ├── 数据分析结果/                
    └── 文献分析结果/                
```

## 🔧 一键安装
```bash
# 进入项目目录，执行：
pip install -r requirements.txt
```

## 🚀 启动程序
```bash
python main.py
```

## 📖 使用指南

### 实验一：金融文献分析
1. **加载文献**：点击"加载文献文件"，选择PDF格式的金融文献
2. **分析内容**：点击"分析文献内容"，系统将进行分词、词频统计和情感分析
3. **可视化**：点击"可视化展示"，查看词云图、词频柱状图和情感分布图
4. **保存结果**：点击"保存文献分析"，结果将保存到 `result/文献分析结果/`

### 实验二：股票数据分析
1. **输入参数**：在界面输入股票代码、开始日期、结束日期
2. **获取数据**：点击"获取数据(爬虫)"，系统将从Tushare获取数据（或使用模拟数据）
3. **机器学习**：点击"机器学习预测"，执行回归、分类、聚类分析
4. **可视化**：选择图表类型后点击"可视化预测结果"

## 🎨 界面说明

### 前端技术实现
- **Tkinter框架**：使用Python标准GUI库构建用户界面
- **主题化组件**：ttk组件提供现代化界面外观
- **布局管理**：Pack和Grid布局系统实现响应式设计
- **多线程处理**：后台任务与UI线程分离，避免界面卡顿

### 主界面布局
- **顶部**：系统标题和实时时钟
- **左侧**：实验一功能区（文献分析、数据分析）
- **右侧**：实验二功能区（数据爬取、机器学习）
- **底部**：状态栏和日志显示区

## 📊 输出结果

### 自动生成的目录结构
```
result/
├── 数据分析结果/
│   ├── [股票名]_分析报告.txt
│   ├── [股票名]_处理数据.csv
│   ├── [股票名]_收盘价走势.png
│   ├── [股票名]_成交量.png
│   ├── [股票名]_涨跌幅分布.png
│   └── [股票名]_价格波动.png
│
└── 文献分析结果/
    ├── [文献名]_词频统计.csv
    ├── [文献名]_情感分析.csv
    ├── [文献名]_分析报告.txt
    ├── [文献名]_词云图.png
    ├── [文献名]_词频图.png
    ├── [文献名]_情感分析图.png
    └── [文献名]_综合分析图.png
```

## 🔌 数据库配置

### MySQL数据库设置
1. **安装MySQL**：确保MySQL服务已安装并运行
2. **创建数据库**：
```sql
CREATE DATABASE finance_db;
USE finance_db;
```
3. **修改配置**：编辑 `database.py` 文件：
```python
host = 'localhost'      # 数据库地址
user = 'root'           # 用户名
password = 'root123'    # 密码（根据实际情况修改）
database = 'finance_db' # 数据库名
```

### 数据库表结构
系统自动创建以下表：
- **stock_daily**：股票日线数据表
- **prediction_results**：预测结果表

## 🌐 爬虫技术实现

### Tushare API配置
1. **注册账号**：访问 [Tushare官网](https://tushare.pro/) 注册
2. **获取Token**：在个人中心获取API Token
3. **配置Token**：修改 `data_fetcher.py`：
```python
self.token = '你的Tushare Token'
```

### 数据获取策略
- **真实数据**：通过Tushare API获取实时金融数据
- **模拟数据**：网络不可用时自动生成随机游走模拟数据
- **数据缓存**：支持本地文件存储和MySQL数据库存储
- **错误处理**：网络异常时自动降级到模拟数据模式

## 📝 注意事项

1. **数据安全**：Tushare Token请妥善保管
2. **存储空间**：定期清理result目录中的历史文件
3. **计算资源**：机器学习任务可能需要较长时间
4. **网络依赖**：Tushare数据获取需要网络连接
5. **版本兼容**：确保使用Python 3.7+和相关依赖包的正确版本
6. **数据库要求**：如需使用数据库功能，请确保MySQL服务正常运行

## 🎓 课程作业特色

1. **技术全面性**：覆盖Python在金融领域的多个应用场景
2. **工程实践**：完整的软件开发生命周期体验
3. **模块化设计**：良好的代码结构和可维护性
4. **用户体验**：直观的GUI界面和完整的功能流程
5. **技术深度**：集成机器学习、数据可视化、数据库等多项技术